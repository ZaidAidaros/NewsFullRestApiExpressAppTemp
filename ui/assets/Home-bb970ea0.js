import{_ as V,o,c as a,w as s,a as r,V as k,b as l,T as b,t as _,d as u,e as x,f as m,h as L,r as d,g as f,i as w,j as S,k as I,l as E,m as T,F as p,R as B,n as A,p as N,q as H,s as U,u as j}from"./index-50d0d424.js";import{A as R}from"./ArticleComp-c7ec9649.js";import{L as v}from"./LoadingAndErrorSc-2f4ab5fb.js";import{V as F}from"./VVirtualScroll-bf8a3f7d.js";import{V as M,a as P,b as q,c as D}from"./VWindowItem-4c40b3b8.js";import{V as W}from"./VMenu-004b703c.js";import"./writterController-5201010d.js";import"./BookMark-5181d7c9.js";import"./lazy-7186a0d1.js";const z={data(){return{news:"lvdfvej  eujdvsdv afg e et "}},mounted(){setInterval(()=>{this.news=null;let e=Date.now();this.news=e+"GTqtg t"},2e3)}};function G(e,n,h,C,t,c){return o(),a(m,{flat:"",class:"text-red pa-2",color:"grey",height:"50px"},{default:s(()=>[r(x,null,{default:s(()=>[r(k,null,{default:s(()=>[l("Arg:")]),_:1}),t.news?(o(),a(b,{key:0,name:"fade"},{default:s(()=>[r(k,null,{default:s(()=>[l(_(t.news),1)]),_:1})]),_:1})):u("",!0)]),_:1})]),_:1})}const O=V(z,[["render",G]]),J={name:"ArticlesList",props:["categoryId","isEditable"],components:{ArticleComp:R,LoadingAndErrorSc:v},data(){return{isLoading:!0,error:!1,page:0,pageSize:0,pageCount:1,count:0,msg:null,sVal:null,articles:[],fArticles:[]}},async mounted(){await this.loadArticles()},methods:{filterArticles:function(){this.fArticles=this.articles.filter(e=>e.title.includes(this.sVal)||e.shortContent.includes(this.sVal)||e.content.includes(this.sVal))},onSChange:function(e){this.sVal=e,this.msg=null,this.error=!1,this.filterArticles()},onSearch:async function(){if(this.sVal){this.isLoading=!0,this.msg=null,this.error=!1,this.page=0;const e=await L.search(this.sVal,this.page,this.categoryId);this.isLoading=!1,this.error=!e.state,this.msg=e.message,e.state&&(e.articles.length?(this.fArticles=e.articles,e.count&&(this.count=e.count,this.pageCount=e.pageCount)):this.msg="No Articles ...")}},goToArticlePage:function(e){this.$router.push({name:"ArticlePage",props:{article:e,isEditable:!1}})},loadArticles:async function(){this.isLoading=!0,this.msg=null,this.error=!1;const e=await L.loadCategoryArticles(this.page,this.categoryId);this.isLoading=!1,this.error=!e.state,this.msg=e.message,e.state&&(e.articles.length?(this.articles.push(...e.articles),e.count&&(this.count=e.count,this.pageCount=e.pageCount),this.page++):this.msg="No Articles ...")}}};function K(e,n,h,C,t,c){const g=d("ArticleComp"),y=d("LoadingAndErrorSc");return o(),f(p,null,[r(m,{flat:""},{default:s(()=>[e.$store.getters.isSearch?(o(),a(m,{key:0,class:"ma-2 pa-2"},{default:s(()=>[r(w,null,{default:s(()=>[r(x,{justify:"center"},{default:s(()=>[r(S,{modelValue:t.sVal,"onUpdate:modelValue":[n[0]||(n[0]=i=>t.sVal=i),c.onSChange],color:"blue",label:"Search",variant:"underlined",clearable:!0},null,8,["modelValue","onUpdate:modelValue"]),r(I,{onClick:c.onSearch,color:"blue",class:"ma-3"},{default:s(()=>[l("Search")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})):u("",!0),!t.isLoading&&!t.msg?(o(),a(F,{key:1,ref:"scrollRef",items:t.sVal?t.fArticles:t.articles,"max-height":"700px"},{default:s(({item:i})=>[r(g,{article:i,isEditable:h.isEditable},null,8,["article","isEditable"])]),_:1},8,["items"])):u("",!0)]),_:1}),r(y,{isLoading:t.isLoading,msg:t.msg,error:t.error},null,8,["isLoading","msg","error"]),t.pageCount>1&&t.page!==t.pageCount?(o(),a(T,{key:0},{default:s(()=>[r(E),r(I,{onClick:c.loadArticles},{default:s(()=>[l("More..")]),_:1},8,["onClick"]),r(w,null,{default:s(()=>[l(_(t.page+"/"+t.pageCount),1)]),_:1})]),_:1})):u("",!0)],64)}const Q=V(J,[["render",K]]);const X={name:"HomeBody",components:{ArticlesList:Q,ResMsg:B,LoadingAndErrorSc:v},data(){return{currentItem:null,isLoading:!1,error:!1,msg:null,categories:[],items:[],more:[]}},async mounted(){await this.setCategories()},methods:{loadCategories:async function(){this.isLoading=!0,this.msg=null,this.error=!1;const e=await L.loadCategories();this.isLoading=!1,e.state?e.categories.length?(this.categories=e.categories,this.$store.dispatch("setArticleCategories",this.categories)):this.msg="No Categories Until Now ....":(this.error=!0,this.msg=e.message)},addItem:function(e){const n=this.items.splice(0,1);this.items.push(...this.more.splice(this.more.indexOf(e),1)),this.more.push(...n),this.$nextTick(()=>{this.currentItem=e.name})},setCategories:async function(){this.$store.getters.getArticleCategories.length?this.categories=this.$store.getters.getArticleCategories:await this.loadCategories();const e=this.categories.length;e>3?(this.more=[...this.categories.splice(3,e)],this.items=[...this.categories.splice(0,3)]):this.items=this.categories,this.items.length&&(this.currentItem=this.items[0].name)}}};function Y(e,n,h,C,t,c){const g=d("ArticlesList"),y=d("LoadingAndErrorSc");return o(),a(m,{flat:"",class:"d-flex flex-column"},{default:s(()=>[r(m,{class:"pa-0 bg-black"},{default:s(()=>[r(M,{modelValue:t.currentItem,"onUpdate:modelValue":n[0]||(n[0]=i=>t.currentItem=i),"fixed-tabs":""},{default:s(()=>[t.items.length?(o(!0),f(p,{key:0},A(t.items,i=>(o(),a(q,{key:i.Id,value:i.name},{default:s(()=>[l(_(i.name),1)]),_:2},1032,["value"]))),128)):u("",!0),t.more.length?(o(),a(W,{key:1},{activator:s(({props:i})=>[r(I,N({variant:"plain",rounded:"0",class:"align-self-center me-4",height:"100%"},i),{default:s(()=>[l(" more "),r(H,{end:""},{default:s(()=>[l(" mdi-menu-down ")]),_:1})]),_:2},1040)]),default:s(()=>[r(U,{class:"bg-grey-lighten-3"},{default:s(()=>[(o(!0),f(p,null,A(t.more,i=>(o(),a(j,{key:i.Id,onClick:te=>c.addItem(i)},{default:s(()=>[l(_(i.name),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})):u("",!0)]),_:1},8,["modelValue"])]),_:1}),r(P,{modelValue:t.currentItem,"onUpdate:modelValue":n[1]||(n[1]=i=>t.currentItem=i)},{default:s(()=>[(o(!0),f(p,null,A([...t.items,...t.more],i=>(o(),a(D,{key:i.Id,value:i.name},{default:s(()=>[r(g,{categoryId:i.Id},null,8,["categoryId"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),r(y,{isLoading:t.isLoading,error:t.error,msg:t.msg},null,8,["isLoading","error","msg"])]),_:1})}const Z=V(X,[["render",Y]]),$={name:"Home",components:{HomeBody:Z,ArgNews:O}};function ee(e,n,h,C,t,c){const g=d("HomeBody");return o(),a(m,{class:"pa-2"},{default:s(()=>[r(g)]),_:1})}const me=V($,[["render",ee]]);export{me as default};
