import{a as h}from"./adminController-2c375c65.js";import{L as x}from"./LoadingAndErrorSc-2f4ab5fb.js";import{W as S}from"./WritterComp-25a58d75.js";import{_ as I,r as p,o as a,g as u,a as r,w as i,c as d,f as m,d as L,F as c,n as g,e as _,j as C,k as A,b as V,i as b,t as w}from"./index-50d0d424.js";import{V as k,a as N,b as y,c as R}from"./VWindowItem-4c40b3b8.js";import{V as T}from"./VVirtualScroll-bf8a3f7d.js";import"./lazy-7186a0d1.js";const O={components:{LoadingAndErrorSc:x,WritterComp:S},data(){return{currentWindow:"newWrittersRequests",currentIndex:0,sVal:null,windows:[{index:0,title:"New Writters Requests",value:"newWrittersRequests",isApproved:null,isStoped:!1,count:0,page:0,writters:[],fWritters:[],loading:!0,isLoaded:!1,error:!1,msg:null,scrollRef:null},{index:1,title:"Writters",value:"writters",isApproved:!0,isStoped:!1,count:0,page:0,writters:[],fWritters:[],loading:!0,isLoaded:!1,error:!1,msg:null,scrollRef:null},{index:2,title:"Stoped Writters",value:"approvedWritters",isApproved:!0,isStoped:!0,count:0,page:0,writters:[],fWritters:[],loading:!0,isLoaded:!1,error:!1,msg:null,scrollRef:null},{index:3,title:"Rejected Writters",value:"rejectedWritters",isApproved:!1,isStoped:!1,count:0,page:0,writters:[],fWritters:[],loading:!0,isLoaded:!1,error:!1,msg:null,scrollRef:null}]}},async mounted(){await this.onTab(this.windows[0])},methods:{onTab:async function(e){this.currentWindow=e.value,this.currentIndex=e.index,e.isLoaded||await this.loadWritters(e)},contains:function(e,t){return e?e.includes(t):!1},onSChange:function(){this.sVal&&(this.windows[this.currentIndex].msg=null,this.windows[this.currentIndex].fWritters=this.windows[this.currentIndex].writters.filter(e=>this.contains(e.firstName,this.sVal)||this.contains(e.middelName,this.sVal)||this.contains(e.lastName,this.sVal)||this.contains(e.familyName,this.sVal)||this.contains(e.nickName,this.sVal)||this.contains(e.fullName,this.sVal)||this.contains(e.nic,this.sVal)||this.contains(e.address,this.sVal)))},onSearch:async function(){if(this.sVal){const e=this.windows[this.currentIndex];e.loading=!0,e.error=!1,e.msg=null,e.page=0;const t=await h.writtersSearch(this.sVal,e.page,e.isApproved,e.isStoped);e.loading=!1,t.state?t.writters.length?(e.fWritters=t.writters,e.page++,e.isLoaded=!0,t.count&&(e.count=t.count)):e.msg="There Is No Writters":(e.msg=t.message,e.error=!0)}},onApprove:function(e){const t=this.windows[this.currentIndex].writters.filter(o=>o.Id!==e.Id);this.windows[this.currentIndex].writters=t,this.windows[this.currentIndex].count--,e.isApproved?this.windows[1].isLoaded&&(this.windows[1].writters.push(e),this.windows[1].count++):this.windows[3].isLoaded&&(this.windows[3].writters.push(e),this.windows[3].count++)},onStop:function(e){console.log(e);const t=this.windows[this.currentIndex].writters.filter(o=>o.Id!==e.Id);this.windows[this.currentIndex].writters=t,this.windows[this.currentIndex].count--,e.isStoped?this.windows[2].isLoaded&&(this.windows[2].writters.push(e),this.windows[2].count++):this.windows[1].isLoaded&&(this.windows[1].writters.push(e),this.windows[1].count++)},deleteWritter:function(e){const t=this.windows[this.currentIndex].writters.filter(o=>o.Id!==e);this.windows[this.currentIndex].writters=t,this.windows[this.currentIndex].count--},loadWritters:async function(e){e.loading=!0,e.error=!1,e.msg=null;const t=await h.getWritters(e.page,e.isApproved,e.isStoped);e.loading=!1,t.state?t.writters.length?(e.writters.push(...t.writters),t.count&&(e.count=t.count),e.page++,e.isLoaded=!0):e.msg="There Is No Writters":(e.msg=t.message,e.error=!0)}}};function j(e,t,o,B,n,l){const W=p("WritterComp"),v=p("LoadingAndErrorSc");return a(),u(c,null,[r(k,{modelValue:n.currentWindow,"onUpdate:modelValue":t[0]||(t[0]=s=>n.currentWindow=s),"fixed-tabs":""},{default:i(()=>[(a(!0),u(c,null,g(n.windows,s=>(a(),d(y,{key:s.value,value:s.value,onClick:f=>l.onTab(s)},{default:i(()=>[V(w(s.title)+" "+w(s.count),1)]),_:2},1032,["value","onClick"]))),128))]),_:1},8,["modelValue"]),e.$store.getters.isSearch?(a(),d(m,{key:0,class:"ma-2 pa-2"},{default:i(()=>[r(b,null,{default:i(()=>[r(_,{justify:"center"},{default:i(()=>[r(C,{modelValue:n.sVal,"onUpdate:modelValue":[t[1]||(t[1]=s=>n.sVal=s),l.onSChange],color:"blue",label:"Search",variant:"underlined",clearable:!0},null,8,["modelValue","onUpdate:modelValue"]),r(A,{onClick:l.onSearch,color:"blue",class:"ma-3"},{default:i(()=>[V("Search")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})):L("",!0),r(N,{modelValue:n.currentWindow,"onUpdate:modelValue":t[2]||(t[2]=s=>n.currentWindow=s)},{default:i(()=>[(a(!0),u(c,null,g(n.windows,s=>(a(),d(R,{key:s.value,value:s.value},{default:i(()=>[r(m,{flat:""},{default:i(()=>[r(T,{ref_for:!0,ref:s.scrollRef,items:n.sVal?s.fWritters:s.writters,height:"700","item-height":"70"},{default:i(({item:f})=>[r(W,{writter:f,onOnApprove:l.onApprove,onOnStop:l.onStop,onOnDelete:l.deleteWritter},null,8,["writter","onOnApprove","onOnStop","onOnDelete"])]),_:2},1032,["items"])]),_:2},1024),r(v,{isLoading:s.loading,msg:s.msg,error:s.error},null,8,["isLoading","msg","error"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])],64)}const G=I(O,[["render",j]]);export{G as default};
